<html>
<head>
<title>Test page</title>
</head>
<body>
	<h1>Test page</h1>

  <table border="1">
  <tr>
  <td>Service Document </td>
  <td>NOT SUPPORTED</td>
  <td><a target="_blank"  href="resources.svc/?">/</a></td>
  </tr>
  
  <tr>
  <td>Metadata </td>
  <td>NOT SUPPORTED</td>
  <td><a target="_blank"  href="resources.svc/$metadata">$metadata</a></td>
  </tr>
  
  <tr>
  <td>Batch</td>
  <td>NOT SUPPORTED</td>
  <td><a target="_blank"  href="resources.svc/$batch">$batch</a></td>
  </tr>
  
  <tr>
  <td>Entity Set</td>
  <td>OK. $format NOT SUPPORTED. Currently JSON only.</td>
  <td><a target="_blank"  href="resources.svc/Foo">Foo</a><br/>
  <a target="_blank"  href="resources.svc/Bar">Bar</a><br/>
  </tr>
  
  <tr>
  <td>Skip <i>n</i> items, top <i>n</i> items, get items count</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo?$skip=2&$top=3&$count=true">Foo?$skip=2&$top=3&$count=true</a></td>
  </tr>
  
  <tr>
  <td>ORDER BY</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo?&$orderby=Name asc,Birthday desc">Foo?$orderby=Name asc,Birthday desc</a></td>
  </tr>
  
  <tr>
  <td>Count</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo/$count">Foo/$count</a></td>
  </tr>
  
  <tr>
  <td>Entity</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)">Foo(1)</a></td>
  </tr>
  
  <tr>
  <td>Primitive property</td>
  <td>OK (what about non-primitive?)</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)/Address">Foo(1)/Address</a></td>
  </tr>
  
  <tr>
  <td>Primitive property (RAW)</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)/Address/$value">Foo(1)/Address/$value</a></td>
  </tr>
  
  <tr>
  <td>Navigation </td>
  <td>NOT SUPPORTED</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)/FavouriteBar">Foo(1)/FavouriteBar</a> is resolved with toString()<br/>
  <a target="_blank"  href="resources.svc/Foo(1)/SomeProperty(0)/SomeOtherProperty">Foo(1)/SomeProperty(0)/SomeOtherProperty</a></td>
  </tr>
  
  <tr>
  <td>Expand sub-items</td>
  <td>NOT SUPPORTED</td>
  <td><a target="_blank"  href="resources.svc/Foo?&$expand=TipoEvento,Entita">Foo?$expand=TipiEvento,Entita</a><br/>
  <a target="_blank"  href="resources.svc/Foo?&$expand=*">Foo?$expand=*</a></td>
  </tr>
  
  <tr>
  <td>WHERE</td>
  <td>DON'T WORK YET</td>
  <td><a target="_blank"  href="resources.svc/Entita?&$filter=contains(Codice, 'U7RM0') and contains(Descrizione, 'ESP')">Entita?$filter=contains(Codice, 'U7RM0') and contains(Descrizione, 'ESP')</a><br/>
  <a target="_blank"  href="resources.svc/Foo?&$filter=(Entita/Acronimo) eq 'U7SC0'">Foo?$filter=(Entita/Acronimo) eq 'U7SC0'</a><br/>
  <a target="_blank"  href="resources.svc/Entita?&$filter=Acronimo eq 'U7SC0'">Entita?$filter=Acronimo eq'U7SC0'</a> <br/></td>
  </tr>
  
  <tr>
  <td>Foo Filter</td>
  <td>DON'T WORK YET</td>
  <td>
  <a target="_blank"  href="resources.svc/Foo?&$filter=TipoEvento/IdTipoEvento eq 1">TipoEvento/IdTipoEvento eq 1</a>
  <br/>
  <a target="_blank"  href="resources.svc/Foo?&$expand=TipoEvento,Entita&$filter=Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1">Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1</a>
  <br/>
  <a target="_blank"  href="resources.svc/Foo?&$expand=TipoEvento,Entita&$filter=Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1 and contains(Tag,'EV')">Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1 and contains(Tag,'EV')</a>
 <br/>
  <a target="_blank"  href="resources.svc/Foo?&$expand=TipoEvento,Entita&$filter=Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1 and contains(Tag,'EV') and TStampEvento gt 2012-05-29T09:13:28Z">Entita/IdEntita eq 6 and TipoEvento/IdTipoEvento eq 1 and contains(Tag,'EV') and TStampEvento gt 2012-05-29T09:13:28Z</a>
  </td>
  </tr>
  
  <tr>
  <td>SELECT</td>
  <td>NOT SUPPORTED (OR NOT YET)</td>
  <td><a target="_blank"  href="resources.svc/Foo?$select=Address">Foo?$select=Address</a></td>
  </tr>
  
  <tr>
  <td>JOIN</td>
  <td>NOT SUPPORTED (OR NOT YET)</td>
  <td><a target="_blank"  href="resources.svc/$crossjoin">$crossjoin...</a></td>
  </tr>
  
  <tr>
  <td>LAMBDA: ALL, ANY</td>
  <td>NOT SUPPORTED</td>
  <td>
  
  <a target="_blank"  href="resources.svc/Foo?&$filter=Entita/all(x:contains(x/Acronimo,'U7'))">Foo?$filter=Entita/all(x:contains(x/Acronimo,'U7'))</a>
  </td>
  </tr>
  
  <tr>
  <td>Literals</td>
  <td></td>
  <td>Numbers: 1234<br/>
  	Strings: 'abc'<br/>
  	Booleans: True<br/>
  	Dates: 2012-05-29T09:13:28<br/>
  	Timestamps: 2018-01-10T09:24:54Z<br/>
  </td>
  </tr>
  
  <tr>
  <td>INSERT (POST).</td>
  <td>OK.</td>
  <td><a href="resources.svc/Foo" onclick="insert();return false;">resources.svc/Foo</a></td>
  </tr>
  
  <tr>
  <td>UPDATE (PUT, not PATCH).</td>
  <td>OK. UPDATE ENUM FAILS!</td>
  <td><a href="resources.svc/Foo" onclick="update();return false;">resources.svc/Foo(1)</a></td>
  </tr>
  
  <tr>
  <td>An example of Function: Clone</td>
  <td>OK</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)/Clone" >resources.svc/Foo(1)/Clone</a></td>
  </tr>
  
  <tr>
  <td>Upload binary data<br/> 
  	
  	</td>
  <td>TODO</td>
  <td><form
  		action="resources.svc/Foo(1)/Image/Upload"
  		enctype="multipart/form-data"
  		method="POST"
  		target="_blank">
  			<!-- should be target=_none -->
  			<input type="file" name="file">
	  		<input type="submit" value="resources.svc/Foo(1)/Image/Upload"/>
  	</form></td>
  </tr>
  
  <tr>
  <td>Download binary data<br/> 
  	
  	</td>
  <td>TODO</td>
  <td><a target="_blank"  href="resources.svc/Foo(1)/Image/Download" >resources.svc/Foo(1)/Image/Download</a></td>
  </tr>
  
  </table>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
function insert() {
	var mydata = {
		name : "Goofy" + Math.round(Math.random()*10000),
		address : "Somewhere 44",
		age :  Math.random()*100
	};
	
	alert("Going to insert " + mydata.name);
	
	$.ajax({
		url: 'resources.svc/Foo',
		type: 'POST',
	    contentType: 'application/json; charset=utf-8',
	    dataType: 'json',
		data: JSON.stringify(mydata),
		success: function(data) {
			alert('Load was performed. data='+JSON.stringify(data));
		},
		error: function(jqXHR, textStatus, errorThrown) {
			alert('Error while loading: ' + errorThrown);
			console.log('OData error was: ' + jqXHR.responseJSON.error.value);
		}
		});
}

function update() {
	var mydata = {
		name : "Mickey" + Math.round(Math.random()*10000),
		address : "Somewhere 44",
		age :  Math.random()*100,
		nice: "MAYBE"
	};
	
	alert("Going to update record 1 with " + mydata.name);
	
	$.ajax({
		url: 'resources.svc/Foo(1)',
		type: 'PUT',
	    contentType: 'application/json; charset=utf-8',
	    dataType: 'json',
		data: JSON.stringify(mydata),
		success: function(data) {
			alert('Load was performed. data='+JSON.stringify(data));
		},
		error: function(jqXHR, textStatus, errorThrown) {
			alert('Error while loading: ' + errorThrown);
			console.log('OData error was: ' + jqXHR.responseJSON.error.value);
		}
		});
}

</script>
</body>
</html>